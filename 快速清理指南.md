# 🚨 快速清理指南 - 5 分鐘解決

## ⚠️ 你的情況

你的 `application.properties` 文件（包含 MySQL 密碼和 Gmail 密碼）已經被推送到 GitHub。

## 🎯 最快解決方案（3 步驟）

### 步驟 1：執行自動清理腳本（2 分鐘）

雙擊運行：
```
EMERGENCY_CLEANUP.bat
```

這會：
- ✅ 備份你的代碼
- ✅ 刪除所有 Git 歷史
- ✅ 替換為安全的配置文件
- ✅ 重新初始化 Git

### 步驟 2：刪除 GitHub 舊倉庫（1 分鐘）

1. 訪問你的 GitHub 倉庫頁面
2. 點擊 **Settings**（設定）
3. 滑到最下面 **Danger Zone**（危險區域）
4. 點擊 **Delete this repository**（刪除此倉庫）
5. 輸入倉庫名稱確認刪除

### 步驟 3：推送到新倉庫（2 分鐘）

1. **在 GitHub 創建新倉庫**
   - 訪問：https://github.com/new
   - 輸入倉庫名稱（例如：`booking-system-v2`）
   - 選擇 **Private**（私有）或 **Public**（公開）
   - **不要**勾選 "Initialize this repository with a README"
   - 點擊 **Create repository**

2. **推送代碼**
   ```cmd
   cd C:\my-booking-app-practice
   
   # 添加遠端倉庫（替換成你的新倉庫 URL）
   git remote add origin https://github.com/你的用戶名/booking-system-v2.git
   
   # 推送
   git branch -M main
   git push -u origin main
   ```

3. **驗證**
   - 訪問新倉庫頁面
   - 檢查 `booking/src/main/resources/application.properties`
   - 確認看到的是環境變數語法：`${DB_PASSWORD:...}`
   - 而不是真實密碼

---

## 🔐 重要：更改密碼

雖然已從 GitHub 刪除，但**已洩露的密碼仍需更改**！

### A. 更改 MySQL 密碼

```cmd
# 方法 1：使用 MySQL Workbench
1. 打開 MySQL Workbench
2. 連接到本地資料庫
3. Server → Users and Privileges
4. 選擇 root 用戶
5. 更改密碼
6. 點擊 Apply

# 方法 2：使用命令列
mysql -u root -p
ALTER USER 'root'@'localhost' IDENTIFIED BY '新密碼';
FLUSH PRIVILEGES;
exit;
```

### B. 更改 Gmail 應用程式密碼

1. 訪問：https://myaccount.google.com/security
2. 搜尋「應用程式密碼」
3. **刪除舊的應用程式密碼**
4. 點擊「產生」創建新密碼
5. 複製新密碼

### C. 更新本地配置

編輯 `booking/src/main/resources/application.properties`：

```properties
# 更新為新密碼（只在本地，不推送到 GitHub）
spring.datasource.password=${DB_PASSWORD:新的MySQL密碼}
spring.mail.password=${MAIL_PASSWORD:新的Gmail應用程式密碼}
```

### D. 更新 Zeabur 環境變數（如果已部署）

在 Zeabur 控制台更新：
- `DB_PASSWORD` = 新的 MySQL 密碼
- `MAIL_PASSWORD` = 新的 Gmail 應用程式密碼

---

## ✅ 完成檢查清單

清理完成後，確認以下事項：

- [ ] 已執行 `EMERGENCY_CLEANUP.bat`
- [ ] 已刪除 GitHub 舊倉庫
- [ ] 已創建新倉庫
- [ ] 已推送代碼到新倉庫
- [ ] 在 GitHub 上確認 `application.properties` 使用環境變數
- [ ] 已更改 MySQL 密碼
- [ ] 已撤銷並重新產生 Gmail 應用程式密碼
- [ ] 本地配置已更新為新密碼
- [ ] 本地測試應用程式可以運行
- [ ] （如有）Zeabur 環境變數已更新

---

## 🛡️ 未來防護措施

### 1. 使用 .gitignore（已設定）

你的專案已經有 `.gitignore`，它會自動忽略敏感文件。

### 2. 使用環境變數（已設定）

現在的配置文件使用環境變數：
```properties
password=${ENV_VAR:本地預設值}
```

### 3. 提交前檢查

每次 `git commit` 前：
```cmd
# 檢查即將提交的內容
git diff --cached

# 搜尋是否有密碼
git diff --cached | findstr /i "password"
```

### 4. 使用 Git Hooks（可選）

創建 `.git/hooks/pre-commit`：
```bash
#!/bin/sh
# 檢查是否包含敏感資訊
if git diff --cached | grep -i "rgsqpqcanthwqars"; then
    echo "錯誤：發現 Gmail 密碼！"
    exit 1
fi
```

---

## 🆘 如果腳本執行失敗

### 方案 B：手動執行

```cmd
cd C:\my-booking-app-practice

# 1. 刪除 Git 歷史
rmdir /S /Q .git

# 2. 替換配置文件
cd booking\src\main\resources
del application.properties
copy application.properties.new application.properties
cd ..\..\..\..

# 3. 重新初始化
git init
git add .
git commit -m "Initial commit"

# 4. 推送到新倉庫
git remote add origin https://github.com/你的用戶名/新倉庫.git
git branch -M main
git push -u origin main
```

---

## 📞 常見問題

### Q: 刪除 Git 歷史會失去什麼？

**A:** 會失去所有提交記錄、分支、標籤。但代碼本身完全保留。

### Q: 一定要刪除舊倉庫嗎？

**A:** 強烈建議！即使刪除提交，有經驗的人仍可能從 GitHub 快取中找到舊版本。

### Q: 可以只刪除特定文件的歷史嗎？

**A:** 可以，但更複雜。參考 `EMERGENCY_CLEANUP_GUIDE.md` 的方法 2。

### Q: 本地開發會受影響嗎？

**A:** 不會！代碼完全相同，只是 Git 歷史重置了。

### Q: Zeabur 需要重新部署嗎？

**A:** 不需要！只需更新環境變數中的密碼即可。

---

## 🎉 總結

**3 個核心步驟：**

1. 🔄 **執行清理腳本** - 自動化處理
2. 🗑️ **刪除舊倉庫** - 徹底移除敏感資訊
3. 🔐 **更改所有密碼** - 確保安全

**預計時間：** 5-10 分鐘

**難度：** ⭐⭐☆☆☆（簡單）

---

**立即開始：雙擊 `EMERGENCY_CLEANUP.bat`！**

